# hhvm - HipHop VM
#
# The HipHopVM server provides a high performance PHP stack and web server.
# modified by pjv from original found here: http://stackoverflow.com/questions/19013516/upstart-script-for-hhvm-hiphop

description     "HHVM server"
author "pjv https://gist.github.com/pjv/2e9ab32d8d9884bf79a4"

start on filesystem or runlevel [2345]
stop on runlevel [!2345]

respawn
respawn limit 10 5
umask 002

pre-start script
  if [ ! -d /var/run/hhvm ]; then
    mkdir -p -m0755 /var/run/hhvm
    chown {{ web_user }}:{{ web_user }} /var/run/hhvm
  fi
end script

exec /usr/bin/hhvm --mode server --user {{ web_user }}
